<!DOCTYPE html>
<html lang="de">
    <head>
        <meta charset="utf-8"/>
        <style>
            * {
                font-family: Helvetica, Arial, sans-serif;
            }
            div#values div {
                width: 20%;
                padding: 10px;
                box-sizing: border-box;
                float: left;
            }
        </style>
        <script src="Chart.js-3.6.0/chart.min.js"></script>
        <script src="chartjs-myimpl.js"></script>
        <script>
            document.addEventListener ("DOMContentLoaded", () => {
                showCharts();

                loadSources();
            });

            function loadSources() {
                fetch("backend/list.php")
                .then(response => response.json())
                .then(json => {
                    const sources = document.getElementById("sources");
                    while (sources.firstChild) {
                        sources.removeChild(sources.firstChild);
                    }
                    json.forEach(el => {
                        const li = document.createElement("li");
                        li.textContent = el;
                        li.onclick = (e) => {
                            window.location.hash = '#' + el;
                            showCharts();
                        };
                        sources.append(li);
                    });
                })
                .catch(e => console.error(e));
            }

    	    function toggleSources() {
                const sources = document.getElementById("sources");
                sources.style.display = sources.style.display == "none" ? "" : "none";
	        }

	        function save(anddelete = false) {
	            window.location = "backend/reset.php?doit=" + (anddelete ? "anddelete" : "true");
	        }
        </script>
    </head>
    <body>
        <div id="values"></div>
        <div id="menu">
            <button onclick="toggleSources()">source</button>
            <ul id="sources" style="display:none">
                <li>db</li>
            </ul>
            <button onclick="save()">save</button>
            <button onclick="save(true)">clear db</button>
        </div>
        <div id="angle">
            <canvas id="angleChart"></canvas>
        </div>
        <div id="temperature">
            <canvas id="temperatureChart"></canvas>
        </div>
    </body>
</html>
